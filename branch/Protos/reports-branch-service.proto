syntax = "proto3";
import "common/report.proto";

option csharp_namespace = "ReportsBranchMicroservice";

package ReportsBranchMicroservice;

service ReportsBranch {
  rpc AggregateUserActivity (AggregateUserActivityRequest) returns (AggregateUserActivityResponse);
  rpc AggregateOverall (AggregateOverallRequest) returns (AggregateOverallResponse);
}

message AggregateUserActivityRequest {
  string flowId = 1;
  string userId = 2;
  int64 timestampFrom = 3;
  int64 timestampTo = 4;
  Granularity granularity = 5;
}

message AggregateUserActivityResponse {
  repeated UserReportPortion accountsPortions = 1;
  repeated UserReportPortion paymentsPortions = 2;
  repeated UserReportPortion loansPortions = 3;
  repeated UserReportPortion cardsPortions = 4;
}

message AggregateOverallRequest {
  string flowId = 1;
  repeated Aggregation aggregations = 2;
  int64 timestampFrom = 3;
  int64 timestampTo = 4;
  Granularity granularity = 5;
  ReportSubject subject = 6;
}

message AggregateOverallResponse {
  repeated OverallReportPortion portions = 1;
}